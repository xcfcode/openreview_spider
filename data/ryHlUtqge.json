{"paper": {"title": "Generalizing Skills with Semi-Supervised Reinforcement Learning", "authors": ["Chelsea Finn", "Tianhe Yu", "Justin Fu", "Pieter Abbeel", "Sergey Levine"], "authorids": ["cbfinn@eecs.berkeley.edu", "tianhe.yu@berkeley.edu", "justinfu@eecs.berkeley.edu", "pabbeel@eecs.berkeley.edu", "svlevine@eecs.berkeley.edu"], "summary": "We propose an algorithm for generalizing a deep neural network policy using \"unlabeled\" experience collected in MDPs where rewards are not available.", "abstract": "Deep reinforcement learning (RL) can acquire complex behaviors from low-level inputs, such as images. However, real-world applications of such methods require generalizing to the vast variability of the real world. Deep networks are known to achieve remarkable generalization when provided with massive amounts of labeled data, but can we provide this breadth of experience to an RL agent, such as a robot? The robot might continuously learn as it explores the world around it, even while it is deployed and performing useful tasks. However, this learning requires access to a reward function, to tell the agent whether it is succeeding or failing at its task. Such reward functions are often hard to measure in the real world, especially in domains such as robotics and dialog systems, where the reward could depend on the unknown positions of objects or the emotional state of the user. On the other hand, it is often quite practical to provide the agent with reward functions in a limited set of situations, such as when a human supervisor is present, or in a controlled laboratory setting. Can we make use of this limited supervision, and still benefit from the breadth of experience an agent might collect in the unstructured real world? In this paper, we formalize this problem setting as semi-supervised reinforcement learning (SSRL), where the reward function can only be evaluated in a set of \u201clabeled\u201d MDPs, and the agent must generalize its behavior to the wide range of states it might encounter in a set of \u201cunlabeled\u201d MDPs, by using experience from both settings. Our proposed method infers the task objective in the unlabeled MDPs through an algorithm that resembles inverse RL, using the agent\u2019s own prior experience in the labeled MDPs as a kind of demonstration of optimal behavior. We evaluate our method on challenging, continuous control tasks that require control directly from images, and show that our approach can improve the generalization of a learned deep neural network policy by using experience for which no reward function is available. We also show that our method outperforms direct supervised learning of the reward.", "keywords": ["Reinforcement Learning"]}, "meta": {"decision": "Accept (Poster)", "comment": "This paper provides an interesting framework for handling semi-supervised RL problems, settings were one can interact with many MDPs drawn from some class, but where only a few have observable rewards; the agent then uses a policy derived from the labeled MDPs to estimate a reward function for the unlabeled MDPs. The approach is straightforward, and one reviewer raises the reasonable concern that this seems to be a fairly narrow definition and approach to the universe of things that could be thought of as semi-supervised reinforcement learning (elements like Laplacian value functions, e.g. proto value functions, for instance, present a very different take on could what also be considered semi-supervised RL).\n \n Overall, however, the main benefit of this paper is that the overall idea here is quite compelling. Even if it's a narrow view on semisupervised RL, it nonetheless is clearly thinking more broadly about skill and data efficiency than what is common in many current RL papers. Given this impressive scope, plus good performance (if only on a relatively small set of benchmarks), it seems like this paper is certainly above bar for acceptance.\n \n Pros:\n + Nice introduction of a new/modified semisupervised reinforce setting\n + Results on benchmarks look compelling (if still fairly small scale)\n \n Cons:\n - Rather limited view of the space of all possible semisupervised Rl\n - Results on hardest task (half-cheetah) aren't _that_ much better than much simpler approaches"}, "review": {"rJ8aR7pXg": {"type": "rebuttal", "replyto": "r1B_zt17e", "comment": "Thank you for your questions.\n\nThe reward function is factorized over time R_\\psi(\\tau) = \\sum_t r_\\psi(s_t, a_t), where s and a denote the state and action [defined just below equation 2]. The form of r_\\psi(s_t, a_t) is a neural network with 2 hidden layers, and a quadratic norm on the output to force the function to be lower bounded. This form follows prior work (Finn et al. ICML \u201816).\n\nThe evaluation is done on both labeled and unlabeled MDPs [see second paragraph of Section 5.2]. Note that all methods reached perfect or near perfect performance on the labeled MDPs for all tasks.\n\nWhile it is true that the cheetah and obstacle tasks have a particular structure where solving the unlabeled MDP would also be successful in the labeled MDP, the two reaching tasks have a different structure, where the agent must execute different actions for each scenario. We designed the experimental tasks to reflect a variety of scenarios where detailed reward supervision is hard to obtain.\n\nOur experiments involved continuous control tasks with a range of difficulty, from planar reaching to cheetah jumping and tasks with vision. In principle, both the problem statement and the proposed method are general to other RL domains and other algorithms for policy optimization and cost learning. Of course, the number of experiments we can fit into a conference submission is limited, so we chose to focus on continuous control domains because those have been most experimented with in cost learning with neural networks (Finn et al. \u201816, Ho et al. \u201816). We have edited the abstract and the last paragraph of the introduction to indicate the focus on continuous control tasks.", "title": "responses to questions"}, "Hy3H3_yml": {"type": "rebuttal", "replyto": "r1qtIh6ze", "comment": "Thank you for your feedback.\n\nRegarding simplicity, we already compare to the simplest possible approach -- fitting the reward function through supervised learning. Our overall method is not complex, as it just amounts to using an inverse RL algorithm to transfer knowledge about the reward from the labeled to the unlabeled MDPs. The particular inverse RL method we use for this is based on MaxEnt IRL, hence corresponding to linearly solvable MDPs and entropic policies (which are just other words for the same framework).\n\nWe agree that the terms \u201clabeled\u201d and \u201cunlabeled\u201d MDP are not as precise as they could be, but we believe that this strikes the right balance between readability and precision. The terms are used by analogy to semi-supervised learning, where there are labeled and unlabeled datapoints. We added this discussion to the paper, in the first paragraph of Section 3, and clarified that the reward exists in the unlabeled MDPs, but just cannot be observed.\n\nAlthough an exploration of SSRL in the context of bandits would be interesting, we believe it would be out of scope of the current paper, which already presents an extensive experimental evaluation with three separate complex domains. We designed a range of experiments to reflect a variety of scenarios where detailed reward supervision is hard to obtain, and we believe that these adequately evaluate the approach.", "title": "response"}, "r1B_zt17e": {"type": "review", "replyto": "ryHlUtqge", "review": "Dear authors, first of all, I find the paper really interesting. Here are some preliminary questions to help me to better understand what you propose:\n\nConcerning the function R_\\psi(t) which aims at evaluating the reward over a trajectory, could you please provide details about the shape of this function since it takes as an input a complete trajectory ?\n\nConcerning the evaluation, it is not clear how it is done (evaluation made only on the unlabeled MDPs, or both the labeled and unlabeled ones ? )\n\nIt seems that the experimental tasks have a particular structure. For example, in the jumping experiment (the agent does not have information concerning the size of the wall) it seems that being able to solve the unsupervised MDPs (wall with a heigh of 0.5) is a good solution for the labeled MDPs (with a smaller wall). Could you please comment on this since it seems (but maybe I am wrong) to bias a little bit the interpretation of the experimental results ? Why not providing the height of the wall as an observation for example and to train with multiple heights ? \n\nThe algorithm is used with MDGPS which supposes the reward to be differentiable. Do you have results on \"more classic\" tasks with classical rewards ? (and discrete actions spaces for example) ? \n\n Thank youThe paper proposes to study the problem of semi-supervised RL where one has to distinguish between labelled MDPs that provide rewards, and unlabelled MDPs that are not associated with any reward signal. The underlying is very simple since it aims at simultaneously learning a policy based on the REINFORCE+entropy regularization technique, and also a model of the reward that will be used (as in inverse reinforcement learning) as a feedback over unlabelled MDPs. The experiments are made on different continous domains and show interesting results\n\nThe paper is well written, and easy to understand. It is based on a simple but efficient idea of simultaneously learning the policy and a model of the reward and the resulting algorithm exhibit interesting properties. The proposed idea is quite obvious, but the authors are the first ones to propose to test such a model. The experiments could be made stronger by mixing continuous and discrete problems but are convincing. ", "title": "Pre-review question", "rating": "8: Top 50% of accepted papers, clear accept", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}, "rkrSDoZ4e": {"type": "review", "replyto": "ryHlUtqge", "review": "Dear authors, first of all, I find the paper really interesting. Here are some preliminary questions to help me to better understand what you propose:\n\nConcerning the function R_\\psi(t) which aims at evaluating the reward over a trajectory, could you please provide details about the shape of this function since it takes as an input a complete trajectory ?\n\nConcerning the evaluation, it is not clear how it is done (evaluation made only on the unlabeled MDPs, or both the labeled and unlabeled ones ? )\n\nIt seems that the experimental tasks have a particular structure. For example, in the jumping experiment (the agent does not have information concerning the size of the wall) it seems that being able to solve the unsupervised MDPs (wall with a heigh of 0.5) is a good solution for the labeled MDPs (with a smaller wall). Could you please comment on this since it seems (but maybe I am wrong) to bias a little bit the interpretation of the experimental results ? Why not providing the height of the wall as an observation for example and to train with multiple heights ? \n\nThe algorithm is used with MDGPS which supposes the reward to be differentiable. Do you have results on \"more classic\" tasks with classical rewards ? (and discrete actions spaces for example) ? \n\n Thank youThe paper proposes to study the problem of semi-supervised RL where one has to distinguish between labelled MDPs that provide rewards, and unlabelled MDPs that are not associated with any reward signal. The underlying is very simple since it aims at simultaneously learning a policy based on the REINFORCE+entropy regularization technique, and also a model of the reward that will be used (as in inverse reinforcement learning) as a feedback over unlabelled MDPs. The experiments are made on different continous domains and show interesting results\n\nThe paper is well written, and easy to understand. It is based on a simple but efficient idea of simultaneously learning the policy and a model of the reward and the resulting algorithm exhibit interesting properties. The proposed idea is quite obvious, but the authors are the first ones to propose to test such a model. The experiments could be made stronger by mixing continuous and discrete problems but are convincing. ", "title": "Pre-review question", "rating": "8: Top 50% of accepted papers, clear accept", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}, "r1qtIh6ze": {"type": "review", "replyto": "ryHlUtqge", "review": "The problem of semi-supervised RL is a good one to formalize, although the approach taken by the paper seems to add perhaps excessive layers of complexity to the simplest possible approach (i.e., linearly solvable MDPs, entropic policies, ...). \n\nFirst, the terminology of \"unlabeled MDP\" seems to grate on the ear. A reward function is not  analogous to a \"label\"  in supervised learning. It does not tell the agent what action to do, since RL is not associative learning. It might hint as to whether an action taken is appropriate or not, but even that is often misleading, since whether the reward is positive, negative or zero might not reveal anything about whether the current action is desirable or not. The reward function is simply a highly noisy indicator of the true value function, and the correct \"label\" for the state is the return. The reward is just the first term in the return. \n\nIt might be helpful to develop an SSRL model based on this idea, where \"unlabeled MDPs\" are simply those where the returns are identically zero (always), and \"labeled\" MDPs are those where the return is the exact value (this corresponds more to the regression setting in the paper). By expanding the return and progressively neutralizing successive terms, one is lead from a fully supervised MDP to a weakly supervised MDP (or even an MDP without  a reward function, which is technically not an MDP at all, but a controlled Markov process). \n\nThe connection to bandit problems might be helpful to discuss as well. What is the equivalent \"unlabeled\" bandit problem, and how does the present approach relate to the huge literature on bandits (which are special cases of MDPs)?In supervised learning, a significant advance occurred when the framework of semi-supervised learning was  adopted, which used the weaker approach of unsupervised learning to infer some property, such as a distance measure or a smoothness regularizer, which could then be used with a small number of labeled examples. The approach rested on the assumption of smoothness on the manifold, typically. \n\nThis paper attempts to stretch this analogy to reinforcement learning, although the analogy is somewhat incoherent. Labels are not equivalent to reward functions, and positive or negative rewards do not mean the same as positive and negative labels. Still, the paper makes a worthwhile attempt to explore this notion of semi-supervised RL, which is clearly an important area that deserves more attention. The authors use the term \"labeled MDP\" to mean the typical MDP framework where the reward function is unknown. They use the confusing term \"unlabeled MDP\" to mean the situation where the reward is unknown, which is technically not an MDP (but a controlled Markov process). \n\nIn the classical RL transfer learning setup, the agent is attempting to transfer learning from a source \"labeled\" MDP to a target \"labeled\" MDP (where both reward functions are known, but the learned policy is known only in the source MDP). In the semi-supervised RL setting, the target is an \"unlabeled\" CMP, and the source is both a \"labeled\" MDP and an \"unlabeled\" CMP. The basic approach is to use inverse RL to infer the unknown \"labels\" and then attempt to construct transfer. A further restriction is made to linearly solvable MDPs for technical reasons. Experiments are reported using three relatively complex domains using the Mujoco physics simulator. \n\nThe work is interesting, but in the opinion of this reviewer, the work fails to provide a simple sufficiently general notion of semi-supervised RL that will be of sufficiently wide interest to the RL community. That remains to be done by a future paper, but in the interim, the work here is sufficiently interesting and the problem is certainly a worthwhile one to study. ", "title": "Simpler framework for SSRL ", "rating": "6: Marginally above acceptance threshold", "confidence": "5: The reviewer is absolutely certain that the evaluation is correct and very familiar with the relevant literature"}, "BknFD3GVg": {"type": "review", "replyto": "ryHlUtqge", "review": "The problem of semi-supervised RL is a good one to formalize, although the approach taken by the paper seems to add perhaps excessive layers of complexity to the simplest possible approach (i.e., linearly solvable MDPs, entropic policies, ...). \n\nFirst, the terminology of \"unlabeled MDP\" seems to grate on the ear. A reward function is not  analogous to a \"label\"  in supervised learning. It does not tell the agent what action to do, since RL is not associative learning. It might hint as to whether an action taken is appropriate or not, but even that is often misleading, since whether the reward is positive, negative or zero might not reveal anything about whether the current action is desirable or not. The reward function is simply a highly noisy indicator of the true value function, and the correct \"label\" for the state is the return. The reward is just the first term in the return. \n\nIt might be helpful to develop an SSRL model based on this idea, where \"unlabeled MDPs\" are simply those where the returns are identically zero (always), and \"labeled\" MDPs are those where the return is the exact value (this corresponds more to the regression setting in the paper). By expanding the return and progressively neutralizing successive terms, one is lead from a fully supervised MDP to a weakly supervised MDP (or even an MDP without  a reward function, which is technically not an MDP at all, but a controlled Markov process). \n\nThe connection to bandit problems might be helpful to discuss as well. What is the equivalent \"unlabeled\" bandit problem, and how does the present approach relate to the huge literature on bandits (which are special cases of MDPs)?In supervised learning, a significant advance occurred when the framework of semi-supervised learning was  adopted, which used the weaker approach of unsupervised learning to infer some property, such as a distance measure or a smoothness regularizer, which could then be used with a small number of labeled examples. The approach rested on the assumption of smoothness on the manifold, typically. \n\nThis paper attempts to stretch this analogy to reinforcement learning, although the analogy is somewhat incoherent. Labels are not equivalent to reward functions, and positive or negative rewards do not mean the same as positive and negative labels. Still, the paper makes a worthwhile attempt to explore this notion of semi-supervised RL, which is clearly an important area that deserves more attention. The authors use the term \"labeled MDP\" to mean the typical MDP framework where the reward function is unknown. They use the confusing term \"unlabeled MDP\" to mean the situation where the reward is unknown, which is technically not an MDP (but a controlled Markov process). \n\nIn the classical RL transfer learning setup, the agent is attempting to transfer learning from a source \"labeled\" MDP to a target \"labeled\" MDP (where both reward functions are known, but the learned policy is known only in the source MDP). In the semi-supervised RL setting, the target is an \"unlabeled\" CMP, and the source is both a \"labeled\" MDP and an \"unlabeled\" CMP. The basic approach is to use inverse RL to infer the unknown \"labels\" and then attempt to construct transfer. A further restriction is made to linearly solvable MDPs for technical reasons. Experiments are reported using three relatively complex domains using the Mujoco physics simulator. \n\nThe work is interesting, but in the opinion of this reviewer, the work fails to provide a simple sufficiently general notion of semi-supervised RL that will be of sufficiently wide interest to the RL community. That remains to be done by a future paper, but in the interim, the work here is sufficiently interesting and the problem is certainly a worthwhile one to study. ", "title": "Simpler framework for SSRL ", "rating": "6: Marginally above acceptance threshold", "confidence": "5: The reviewer is absolutely certain that the evaluation is correct and very familiar with the relevant literature"}}}