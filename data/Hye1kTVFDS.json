{"paper": {"title": "The Variational Bandwidth Bottleneck: Stochastic Evaluation on an Information Budget", "authors": ["Anirudh Goyal", "Yoshua Bengio", "Matthew Botvinick", "Sergey Levine"], "authorids": ["anirudhgoyal9119@gmail.com", "yoshua.bengio@mila.quebec", "botvinick@google.com", "svlevine@eecs.berkeley.edu"], "summary": "Training agents with adaptive computation based on information bottleneck can promote generalization. ", "abstract": "In many applications, it is desirable to extract only the relevant information from complex input data, which involves making a decision about which input features are relevant.\nThe information bottleneck method formalizes this as an information-theoretic optimization problem by maintaining an optimal tradeoff between compression (throwing away irrelevant input information), and predicting the target. In many problem settings, including the reinforcement learning problems we consider in this work, we might prefer to compress only part of the input. This is typically the case when we have a standard conditioning input, such as a state observation, and a ``privileged'' input, which might correspond to the goal of a task, the output of a costly planning algorithm, or communication with another agent. In such cases, we might prefer to compress the privileged input, either to achieve better generalization (e.g., with respect to goals) or to minimize access to costly information (e.g., in the case of communication). Practical implementations of the information bottleneck based on variational inference require access to the privileged input in order to compute the bottleneck variable, so although they perform compression, this compression operation itself needs unrestricted, lossless access. In this work, we propose the variational bandwidth bottleneck, which decides for each example on the estimated value of the privileged information before seeing it, i.e., only based on the standard input, and then accordingly chooses stochastically, whether to access the privileged input or not. We formulate a tractable approximation to this framework and demonstrate in a series of reinforcement learning experiments that it can improve generalization and reduce access to computationally costly information.", "keywords": ["Variational Information Bottleneck", "Reinforcement learning"]}, "meta": {"decision": "Accept (Poster)", "comment": "Existing implementation of information bottleneck need access to privileged information which goes against the idea of compression. The authors propose variational bandwidth bottleneck which estimates the value of the privileged information and then stochastically decided whether to access this information or not. They provide a suitable approximation and show that their  method improves generalisation in RL while reducing access to expensive information.\n\nThese paper received only two reviews. However, both the reviews were favourable. During discussions with the AC the reviewers acknowledged that most of their concerns were addressed. R2 is still concerned that VBB does not result in improvement in terms of sample efficiency. I request the authors to adequately address this in the final version. Having said that, the paper does make other interesting contributions, hence I recommend that this paper should be accepted."}, "review": {"T6aT6-i3bd": {"type": "rebuttal", "replyto": "kjZ93onALg", "comment": "Hello Rakesh, \n\nThanks for taking time and reading our work.\n\nyou are right regarding missing brackets. Regarding the sign, there's \\beta in the objective, \ndepending upon which it can either be positive or negative. ", "title": "Thanks."}, "SJe_pvITtH": {"type": "review", "replyto": "Hye1kTVFDS", "review": "Summary - The paper proposes an approach, called the Variational Bandwidth Bottleneck (VBB), capable of compressing only a part of the input and still learn representations that are informative of the output. The approach is motivated from the following perspective -- there might be situations where a ``part\u2019\u2019 of the input is privileged in the sense that it may be costly / wasteful to maintain access to all the time, thereby rendering the standard IB pipeline infeasible (as it requires unrestricted access to the entire input). By breaking down the input into standard (always available) and privileged (not always available) components, the paper proposes a module that decides whether to access the privileged input during compression based on the standard input. The goal is to be able to decide when to access privileged information and not how to break the overall input into standard and privileged components. The approach tackles a narrow subset of problems compared to the standard information bottleneck. The authors show the applicability of the proposed approach in reinforcement learning setups -- specifically, (1) when to access an expensive model-based planner for goal-driven navigation; (2) when to access goal-information in goal-driven navigation and (3) treating communication in a multi-agent cooperative setting as ``privileged\u2019\u2019 information. The experimental results demonstrate that VBB accesses privileged information in a feasible and minimal manner and results in better generalization performance.\n\nStrengths\n\n- Apart from the flaws (highlighted in weaknesses), the paper is well-written and generally easy to follow.\n\n- The problem statement is well-motivated. The authors did a good job of first identifying when the standard IB approach would be infeasible / costly -- even though representations are compressed and relevant, computing them still requires unrestricted access to input -- and then motivating the need for selective access to information while decision-making. The problem is well-grounded in the experimental settings the authors provide results for.\n\n- Apart from the concerns (highlighted in weaknesses), the experimental results generally support the claims of the paper. Results in Sec. 7.1 (loosely) demonstrate that VBB accesses privileged information states where degree of freedom in terms of possible trajectories is higher -- this result, although not explored in it\u2019s entirety, also correlates with notions of decision-states (as pointed out by authors) and bottleneck states in the existing literature. Results in Sec. 7.2 demonstrate improved generalization performance in terms of transfer. Additionally, results in Table.3 suggest that VBB accesses privileged information the least number of times. Similarly, results in Sec. 7.3 indicate VBB results in improvements in performance in the multi-agent setting while resulting in minimal communication among the agents. The baselines being compared with in the paper are also reasonable.\n\n- The problem statement and the proposed approach have some degree of novelty. Most works along the lines of restricting access to relevant information still assume unrestricted access to the `entire\u2019 information. \n\nWeaknesses\n\nThat being said, the paper does have some flaws / clarity issues that make several associated details confusing when judged in context of prior work. These concerns (in addition to the strengths highlighted above) mostly surrounding experiments form the basis of my rating and addressing these would definitely make the paper stronger.\n\n- One of the underlying motivations / intuitions behind restricting access to the privileged information is that fact that -- \u201c..avoid accessing the privileged input because we want to generalize with respect to it..\u201d. This statement in isolation is misleading and makes things unclear. From a complete generalization standpoint, preventing the encoder from overfitting to the input (\u2018privileged\u2019 or \u2018standard\u2019) can be addressed by just tracking the relevance (predictive performance) based on the representations on a held-out set. Unless I am missing something, generalization of the learned representations in standard IB becomes major problem only when we restrict (costly or otherwise) access to the privileged input. The statement seems to suggest that learning representations completely and generally agnostic to the privileged input is a good idea. However, this is only true when at test-time, the privileged input may be significantly different than what was seen during training time -- a different model-based planner / entirely different goal-specifications, etc. Could the authors comment more on this and reframe the intuition wherever applicable?\n\n- Last 3 lines of the 1st paragraph in section 3 (page 2) are incomplete -- \u201c...constraining the channel capacity .. is permitted to differ from the prior r(Z)....\u201d. The difference in the posterior p(Z|X) and the prior r(Z) quantify the channel capacity only under expectation over the distribution over inputs -- p(X). Therefore, in practice, it is also governed by the empirical distribution of the data (see page 4 of https://arxiv.org/pdf/1612.00410.pdf). The authors should change the lines to reflect the same.\n\n- One of the key contributions of the paper is to develop a mechanism where one isn\u2019t required to access the privileged input all the time -- depending on the standard input, one can decide whether to access the privileged information. This manifests in form of a mixture-distribution over a dirac-delta transformation of the deterministic encoder and a prior distribution. At inference-time, the channel capacity (d_cap, based on the standard input) can be used to decide whether to access the privileged information or not. There\u2019s lack of clarity in terms of what happens at training time -- is it the case that (1) d_cap is computed, f(s, g) is also computed and based on the KL-term in Eq (3), B(S) is incentivized to generate d_cap that results in less frequent access the privileged information (d_cap < 0.5 for the most part) or (2) d_cap is computed, a sample is drawn from the bernoulli and z is sampled from either r(Z) or \\del_(f(S, G) and KL is either 0 (if z ~ r(Z)) or a finite value (if z ~  \\del_(f(S, G))? (1) involves an exact computation and always requires access to G (privileged input) during training whereas (2) is approximate and does not always require access to G. It\u2019s unclear what the pipeline is from the paper. Can the authors clarify this? Are there specific reasons why (1) / (2) was chosen?\n\n- Experimental Results: Highlighting these below:\n     - In the experimental setting of Figure 2, do the authors notice any (1) qualitative differences in terms of where the agent accesses the output of the planner when InfoBot is used (adapted to this setting) and (2) quantitative differences (Table. 2) in terms of how often does InfoBot and the other proposed baselines access the planner output at junctions and hallways? Junctions in 2D mazes can potentially be identified as important decision states using simpler approaches. As a demonstrative experiment, the key point to be made using this experiment seems to be how often does VBB access the planner output compared to InfoBot and other baselines. \n\n    - In Sec. 7.2, it is unclear how VBB is being used to generalize to novel environments -- as in, is the pipeline same as InfoBot, where a frozen encoder is used to provide an exploration incentive? \n\n    - While the generalization results in Table. 2 are impressive in terms of success values, I think it lacks a few numbers (assuming the transfer pipeline to novel environments is same as InfoBot) -- given that the environments being tested on are different from InfoBot, how well do count-based exploration and goal-conditioned A2C baselines perform? This is to understand whether InfoBot is the right thing to compare with in these environments. \n\n    - Furthermore, for the goal-driven navigation set of experiments can the authors report comparisons in terms of sample-efficiency as well -- how do success-rates and average task-returns vary with time-steps of training? \n\n    - For results in Sec. 7.3, Table. 4, I would encourage the authors to compare with IC3Net (https://arxiv.org/pdf/1812.09755.pdf) which learns \u201cwhen to communicate\u201d in a multi-agent setting irrespective of whether it\u2019s a cooperative situation or not.\n\nReasons for rating\n\nApart from the points mentioned above, I don\u2019t have major weaknesses to point out. The paper is generally easy to follow and the proposed approach and problem statement is well-grounded and somewhat novel. However, the paper suffers from lack of experimental details and comparisons (and other weaknesses highlighted above) and therefore I am inclined towards my current rating. Addressing those would significantly benefit the paper and help me in  increasing my score.\n", "title": "Official Blind Review #2", "rating": "6: Weak Accept", "confidence": 2}, "B1xJyr2osB": {"type": "rebuttal", "replyto": "SyxBif3ooH", "comment": "We appreciate the response by the reviewer. \n\n\"comparisons w.r.t. sample-efficiency of VBB versus InfoBot (and other approaches). While success and frequency of accessing privileged information are interesting metrics to look at, comparisons w.r.t. sample-efficiency would reflect if restricted access to privileged information via VBB results in faster training -- by very carefully accessing privileged information only at specific states.\"\n\nWe did not observe any change in sample efficiency b/w InfoBot as well as the proposed method.\nWe note that in the current work goal of the proposed method is not to obtain better sample efficiency, but to generalize better with respect to the privileged input.  Future work would investigate how to combine efficiently the proposed information regularizer with other information theoretic exploration methods which can also improve sample efficiency. \n\nAnother interesting thing which we observed was, that in our navigation experiments we measured percentage of time steps on which (Infobot as well as the proposed method) access the goal information when the agent is near the junction point (or branching points) in the maze. We observe that the\nproposed method learns to access the privileged input (in this case, the goal) only when necessary, as compared to Infobot baseline. This even holds when we evaluate on different task distribution as compared to what it was trained on. (For more details, ref. Tab 3 in the main paper). This further shows, that the encoder in \"Infobot\" can be improved by conditionally computing whether the privileged information should be accessed or not (as in the proposed method).\n\n\n\"Given the responses to my comments, I am generally supportive of the paper.\"\n\nWe appreciate that the reviewer supports the paper. Would reviewer like to revise their score ? \n\nThanks a lot for your time. :)\n", "title": "comparisons w.r.t. sample-efficiency of VBB versus InfoBot + revise score ? "}, "SklhHucooB": {"type": "rebuttal", "replyto": "SJe_pvITtH", "comment": "Dear reviewer #2, \n\nWe\u2019d like to thank you again for your review and feedback! We have provided response to your questions. In particular, we clarified connections to InfoBot, did comparisons to Count Based exploration, some more experiments with I3C paper.\n\nWould you have any other questions regarding the rebuttal?  \n\nSince the review discussion period is going to end, we would appreciate any feedback that you might have. We would be very happy to provide more clarifications, if any. \n\nMany thanks again for your review, feedback and time. We appreciate it.\n", "title": "Feedback ? "}, "HylyE_2FiH": {"type": "rebuttal", "replyto": "SJe_pvITtH", "comment": "R2, We believe, we have addressed your concerns and clarified some of your points. \n\nWe hope to have changed your assessment of our work for the better; should that not be the case, please do not hesitate to get in touch with us.\n\nThanks for your time. ", "title": "Updated Impression ?"}, "HkloHmR-sB": {"type": "rebuttal", "replyto": "H1xDZmAWsH", "comment": "\u201cthe authors to compare with IC3Net\u201d\n\nWe thank the reviewer for the reference. As asked by reviewer, we ran the IC3Net baseline for our task by varying different number of agents. IC3Net performs better for 6 agents, but VBB scales better (and outperforms IC3Net baseline) when there are more number of agents (like 10 or 15). We also study how many times an agent access the privileged input (in brackets). For all the scenarios, (6 agents, 10 agents and 15 agents), proposed method (VBB) access privileged input less number of times as compared to IC3Net. We think the reason VBB scales better (in this scenario is because VBB is fully differentiable, but in IC3Net requires a non-differentiable decision. Future work would be how to improve IC3Net using ideas from VBB. (Less is better).\n\nMethod              6 agents                              10 agents                          15 agents\nVBB (ours)        4.72 (23%)                            5.22 (34%)                            5.76 (38%)                   \nIC3net               4.68 (34%)                            5.28 (42%)                           5.91 (45%) \n\nThanks again for your time in reviewing our submission. We really appreciate it. \n\n", "title": "Comparison with IC3net (3/3)"}, "r1gG7rR-ir": {"type": "rebuttal", "replyto": "H1lnUmn7cH", "comment": "We thank the reviewer for their feedback and their generally positive assessment of our work.\n\n\u201cI wonder how it connects to active learning or more specifically \"active feature acquisition\"\n\nWe thank the reviewer for pointing this out. We agree that their are some intriguing connections to \u201cactive feature acquisition\u201d. More generally, the  efficient use of limited computational resources is probably an important ingredient.  There\u2019s a whole field of rational meta-reasoning which decide which computations to perform but this is computationally intractable. VBB provides a tractable way to maintain a trade-off b/w \u201ccost\u201d of performing a computation, and \u201cvalue\u201d of computation, in the sense perform a computation if value of computation exceeds that of the cost of computation. Future work would be to rigorously study this in active feature acquisition scenario.\n\n\n\u201cTypos\u201d\n\nWe thank the reviewer for pointing out these corrections. We would update it in the next version of the paper. \n\n\u201cReferences\u201d\n\nWe thank the reviewer for those references. We\u2019ll look into them. \n\nAre there any other experiments or clarifications that we can provide such that would help to improve the understanding of our work and hence making it more likely for you to raise your score?\n\nThanks again for your time in reviewing our submission. We really appreciate it. ", "title": "Response to Reviewer"}, "BJxTAM0bsS": {"type": "rebuttal", "replyto": "SJe_pvITtH", "comment": "\nWe thank the reviewer for their feedback and their generally positive assessment of our work. We believe this would further improve the readability of our work. Thanks!!\n\n\nWe have ran additional experiments requested by the reviewer. To summarize. \n(a) We ran the comparison to I3C as requested by reviewer.\n(b) We have also compared to count based exploration as requested by reviewer. \n\n\u201c..avoid accessing the privileged input because we want to generalize with respect to it..\u201d\n\nThe VBB is indeed meant to provide robustness to distributional shift. While this can happen, as the reviewer says, in cases where there \"a different model-based planner / entirely different goal-specifications,\" this kind of distributional shift more commonly occurs when we study generalization to related but distinct problem instances. For example, in the settings considered in our experiments, we train on procedurally generated mazes with different sizes (like different number of rooms, and size of different rooms) during training and testing.\n\n\u201cthe authors should change the lines to reflect the same.\u201d\n\nThanks for pointing this out. Its indeed an omission from our side. \n\n\u201cIt\u2019s unclear what the pipeline is from the paper. Can the authors clarify this? \u201d\n\nWe follow the first pipeline. \n(1) d_cap is computed.\n(2)  f(s, g) is also computed and based on the KL-term in Eq (3).\n(3) B(S) is incentivized to generate d_cap that results in less frequent access the privileged information.\n(4) During test time, we sample from the bernouilli treating d_prob as the probability. Main motivation was, it resonates well with our result in Proposition 1, and during training everything is still differentiable ( though we do need to access privileged information during training)\n", "title": "Response to Reviewer (1/3)"}, "H1xDZmAWsH": {"type": "rebuttal", "replyto": "BJxTAM0bsS", "comment": "\u201cas in, is the pipeline same as InfoBot, where a frozen encoder is used to provide an exploration incentive? it is unclear how VBB is being used to generalize to novel environments\u201d\n\nAuthors in InfoBot evaluate generalization by 2 ways. (1) using policy transfer, and (2) Using the encoder for providing exploration bonus in a new environment.  In the proposed method, we evaluate generalization by directly transferring policy in a new environment (and not by freezing the encoder, and providing exploration bonus). Our motivation is we want to test whether agent can generalize better by dynamically deciding when to access the privileged input.  Hence, we  demonstrate that training an agent with a VBB leads to more effective policy transfer (as compared to just having a goal conditioned bottleneck). We train policies on smaller versions of the MiniGrid environments, but evaluate them on larger versions throughout training. This is similar to section 4.2 in InfoBot paper. (https://openreview.net/pdf?id=rJg8yhAqKm).\n\n\u201cComparison to Count based exploration\u201d\n\nWe compare the proposed method to Goal Conditioned A2C (UVFA) as in Table 2, as well as Count based exploration as requested by the reviewer. For this paper, we consider direct policy transfer where we train policy in one environment and test it in other environments. \n\nMethod                                   FindObjS7       FindObjS10\nVBB                                           73% \u00b1 2%          57% \u00b1 4%\nGoal conditioned A2C            40% \u00b1 2%          24% \u00b1 3% \nCount Based Exploration      45% \u00b1 3%          38% \u00b1 5%\n", "title": "VBB and InfoBot (2/3)"}, "H1lnUmn7cH": {"type": "review", "replyto": "Hye1kTVFDS", "review": "This paper proposes a type of conditional Information Bottleneck (IB) that addresses the following problem: given that some features may be expensive to obtain for use in prediction, when should they be obtained such that the overall benefit outweighs the cost? A variant of the IB is proposed to model this question. However, optimization is intractable. The paper replaces a certain non-differentiable operation by a deterministic neural network which outputs the probability of seeking the expensive features. The main application here is reinforcement learning, where an agent could compute some plan or communicate with other agents at a cost, and the goal is to solve the task more efficiently while making use of this additional information. It is shown that the proposed method, VBB, makes judicious use of the limited number of costly feature acquisitions it makes, resulting in improved task performance across 3 tasks.\n\nI am not an expert on the topic, but I find that this paper is well-written and tackles a basic question with effective methods that work well in practice. \n\nHowever, since the problem is so basic, I wonder how it connects to active learning or more specifically \"active feature acquisition\":\n\n-Saar-Tsechansky, Maytal, Prem Melville, and Foster Provost. \"Active feature-value acquisition.\" Management Science 55.4 (2009): 664-684.\n-Shim, Hajin, Sung Ju Hwang, and Eunho Yang. \"Joint active feature acquisition and classification with variable-size set encoding.\" Advances in Neural Information Processing Systems. 2018.\n-Ma, Chao, et al. \"Eddi: Efficient dynamic discovery of high-value information with partial VAE.\" arXiv preprint arXiv:1809.11142 (2018). \n\nMinor:\n- \"((Bahdanau et al., 2014; Mnih et al., 2014; Xu et al., 2015))\": double parentheses\n- \"minimizing unnecessary access? . We compare\": drop the . after ?\n- \"to dynamically adjusts\" --> \"to dynamically adjust\"\n- \"The agent always access the\" --> \"The agent always accesses the\"\n- \"Tables 3a, 3b compares\": no such tables in the paper\n- \"each method acsess the\" --> \"each method accesses the\"", "title": "Official Blind Review #1", "rating": "6: Weak Accept", "confidence": 1}}}