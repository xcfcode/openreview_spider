{"paper": {"title": "RG-Flow: A hierarchical and explainable flow model based on renormalization group and sparse prior", "authors": ["Hong-Ye Hu", "Dian Wu", "Yi-Zhuang You", "Bruno Olshausen", "Yubei Chen"], "authorids": ["~Hong-Ye_Hu1", "wdphy16@pku.edu.cn", "yzyou@physics.ucsd.edu", "~Bruno_Olshausen1", "~Yubei_Chen1"], "summary": "We incorporate the key idea of renormalization group (RG) and sparse prior distribution to design a hierarchical flow-based generative model, which can separate different scale information of images with disentangle representations at each scale.", "abstract": "Flow-based generative models have become an important class of unsupervised learning approaches. In this work, we incorporate the key idea of renormalization group (RG) and sparse prior distribution to design a hierarchical flow-based generative model, called RG-Flow, which can separate different scale information of images with disentangle representations at each scale. We demonstrate our method mainly on the CelebA dataset and show that the disentangled representation at different scales enables semantic manipulation and style mixing of the images. To visualize the latent representation, we introduce the receptive fields for flow-based models and find receptive fields learned by RG-Flow are similar to convolutional neural networks. In addition, we replace the widely adopted Gaussian prior distribution by sparse prior distributions to further enhance the disentanglement of representations. From a theoretical perspective, the proposed method has $O(\\log L)$ complexity for image inpainting compared to previous flow-based models with $O(L^2)$ complexity.", "keywords": ["Unsupervised learning", "representation learning", "flow-based generative model", "renormalization group", "sparse encoding"]}, "meta": {"decision": "Reject", "comment": "This paper proposes a hierarchical flow-based generative model to learn disentangled features at different levels of abstractions.  The key technical contribution is a combination of renormalization group and flow-based models. The reviewers do find the idea interesting. However, the merit of the work with respect to StyleGAN and StyleFlow has not been well established. AR3 made the following comment:  \u201cSpecially, compared with the style-based generator[1,2], \u2026, I don\u2019t find superiorities of the proposed method.\u201d The authors responded to the comment briefly (but not convincingly) in their rebuttal. There is no mention of it in the revised paper. A proper account of the issue would require major revision to the paper."}, "review": {"67X7r-ufl1": {"type": "review", "replyto": "Mwuc0Plt_x2", "review": "The paper proposes a new architecture for flow based generative models. The model imposes a hierarchical structure over information at different scales. The paper shows that the hierarchical structure results in disentangled features at different levels of abstractions. The paper claims that the approach is based on the renormalization group\n\n\nStrengths:\n+ The overall structure of the approach is intuitive, and the writing/figures are understandable \n+ I like how the approach naturally produces disentangled features at different levels of abstraction. \n+ Figure 9 demonstrates how the sparse prior leads to better disentanglement than the Gaussian prior. Due to the rotation invariance of the Gaussian prior, the hidden dimensions of other flow based generative models like Real NVP don't have grounded semantic meaning.\n+ The hierarchical approach shows a small improvement over \n\n\nWeaknesses:\n- (Intro/related work) There should be more discussion how this paper relates to Neural Network Renormalization Group (Li & Wang). Some more background/examples of the renormalization group in physics / meaning of the disentangler/decimator would be helpful\n\n- There is no evaluation of the image inpainting performance. Some other papers (Structured Output Learning with Conditional Generative Flows ,Lu & Huang) use PSNR. \n- Constrained NVP seems to be too weak a baseline for the image inpainting task. Are there more reasonable comparisons? Since the paper claims a log(L) vs L^2 improvement, timing or flop counts should be used to compare to Real NVP. \n- The paper provides limited quantitative results and comparisons. Only qualitative comparisons are provided on the in-painting task. There are no quantitative results provided in the main paper, and only results on CelebA, CIFAR-10, and 3D chair in the appendix.  There is no discussion of the 3D chair experiment in the appendix.\n\nSome minor points:\n* Notation in Eq 5. should be improved for better understanding\n* What is the reason for the checkerboard artifacts shown in the progressive generation (Figure 3)?  \n* While theoretically each pixel only depends on log(L) latent variables\n\nUpdate: The authors response has addressed my major concerns. Particularly, the revised version is more clear about how this paper relates to prior work, more comparisons/metrics are added, and issues I had related to clarity were addressed. The revised version has significantly expanded the scope of experiments, which better demonstrate the advantage of hierarchical features for normalizing flows. I have update my rating to marginal accept", "title": "RG-Flow Review", "rating": "6: Marginally above acceptance threshold", "confidence": "3: The reviewer is fairly confident that the evaluation is correct"}, "ZcBHIOU991": {"type": "review", "replyto": "Mwuc0Plt_x2", "review": "Summary:\nThe paper introduces an RG-Flow model -- a hierarchical flow model based on the idea of the renormalization group. The experiments suggest that this model is expressive and capable of learning the disentangled representations at different scales. Additionally, the authors show how this method can be adapted for image inpainting and theoretically analyze its complexity.\n\nPros:\n- Novel and interesting idea.\n- The proposed method allows for separating the features at different scales (at low, mid, and high levels) due to the hierarchical structure of the model.\n\nConcerns:\n- The paper would benefit from additional experiments and comparison to other methods. For example, you can experiment with the datasets specific for the analysis of disentangled representations, e.g., Shapes 3D, MPI 3D, etc.\n- The paper lacks the quantitative assessment of the degree of disentanglement of learned representations. I suggest to refer to the paper [1] for the list of disentanglement metrics. While they were invented for VAE-based models, you can adapt it to your method.\nSimilarly, you could add the assessment of the inpainting quality apart from the visual evaluation in Figure 6.   \n\nQuestions: \n- Did you measure the quality of generated images, e.g., by computing FID or Inception score? While the samples for the CelebA dataset look good, the samples for CIFAR-10 (Fig.8) are not impressive.\n-  I did not find any details on the experiments on the 3D Chair dataset apart from Table 1 in the Appendix. Was the setting the same as for CelebA and CIFAR-10 datasets? Is it possible to compare the results of RG-Flow to Real NVP for the 3D Chair dataset?\n\nComments:\n- I suggest adding the paper [2] to the related work; this paper introduces Multiscale Entanglement Renormalization Ansatz (MERA), a structure similar to your network.\n- Take a look at the paper [3], bridging the entanglement renormalization and wavelets. \n\nUPD: I am satisfied with the authors' response, and therefore I increase the score. \n\nReferences:\n\n[1] Locatello, F., Bauer, S., Lucic, M., Raetsch, G., Gelly, S., Sch\u00f6lkopf, B., & Bachem, O. (2019, May). Challenging common assumptions in the unsupervised learning of disentangled representations. In international conference on machine learning (pp. 4114-4124).\n\n[2] Vidal, G. (2008). Class of quantum many-body states that can be efficiently simulated. Physical review letters, 101(11), 110501.\n\n[3] Evenbly, G., & White, S. R. (2016). Entanglement renormalization and wavelets. Physical review letters, 116(14), 140403.", "title": "Interesting idea, but needs more experiments", "rating": "6: Marginally above acceptance threshold", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}, "GXjntF-8R3f": {"type": "rebuttal", "replyto": "ZcBHIOU991", "comment": "Thanks for taking time reviewing our paper and pointing out some questions.\n\n---\n1. \"The paper would benefit from additional experiments and comparison to other methods .. specific for the analysis of disentangled representations ..\"\n\nA major focus and contribution of this work is on disentangling representations at different scales or spatially separated, as renormalization group guarantees the separation of information at different scales: it pushes the large-scale information to the high level layer and leaves the detailed information in the low level layer.\n\nIn the updated \"Experiments\" section and Appendix B, we have added our synthetic toy datasets MSDS1 and MSDS2 to directly illustrate that RG-Flow can naturally capture global and local features separately. In comparison, we find Real NVP fails to capture the global and local characteristics of the datasets. For the human face dataset, we also add receptive fields learned by Real NVP in Appendix C. It directly shows that the mid level and low level representations of human faces are missing.\n\nFor spatially separated features, they are disentangled in a sense that changing one will not affect the other, because their representations have non-overlapping receptive fields. For example, in the human face dataset, the mid-level factor of eyes will only change the eyes and not affect the hair, since they do not overlap.\n\nWe think the disentanglement of high level representations are important questions. The disentanglement-specific methods, such as beta-VAE, use independence of latent variable as a drive to encourage high level disentanglement. In the flow based models, the latent variables are already independent. So we impose sparse prior as heuristic method to break the symmetry of latent space. But we are aware that sparsity does not guarantee disentanglement of high level representations [1]. In addition, we feel that disentangling just high-level factors with overlapping receptive fields is an ill-defined problem without inductive bias, which is also the main conclusion of [2]. So we acknowledge disentanglement of high level (overlapping) representations is another topic, which may be subject to our future work.\n\n[1] Geoffrey Roeder, et al., On Linear Identifiability of Learned Representations. (2020)\n\n[2] Francesco Locatello, et al., Challenging Common Assumptions in the Unsupervised Learning of Disentangled Representations. (2019)\n\n---\n\n2. \"Similarly, you could add the assessment of the inpainting quality apart from the visual evaluation in Figure 6.\"\n\nThanks for the comment and we have added the metrics of PSNR and Inception-PSNR for inpainted images in Appendix F, which are consistent with the intuitive results in Fig. 7.\n\n---\n3. \"Did you measure the quality of generated images, e.g., by computing FID or Inception score? ..\"\n\nThe quality of the generated images can be measured by bit per dimension (BPD), which is reported in Appendix G. Unlike generative adversarial networks, BPD can be directly computed in flow-based generative models.\n\nOur network achieves comparable BPD performance to Real NVP with approximately the same number of trainable parameters, when trained on CelebA and CIFAR-10 datasets. The performance of RG-Flow depends largely on the family of local bijective maps. Since we use the bipartite bijective maps, which are also used in Real NVP, Real NVP is a natural choice for the comparison. We expect that the advantage of RG-Flow can be transferred to more advanced bijective maps, such as invertible convolutions and i-ResNet to achieve better performance.\n\nBased on your suggestion, we also add FID score as another metric in Appendix G. Please note that FID score is not widely adopted to assess flow-based models since flow-based models can directly give the probability density of each generated sample, which GAN cannot. BPD may be a more fair metric on datasets of specific fields like human faces and synthetic datasets, and it avoids the bias from the knowledge encoded in Inception-v3. \n\n---\n\n4. \"..Was the setting the same as for CelebA and CIFAR-10 datasets?\"\n\nWe will include the implementation details and results in Appendix G of the revision. The settings for 3D Chair dataset is mostly the same as for other experiments. This experiment is used to show a limitation of RG-Flow, which is discussed in \"Discussion and conclusion\" section. If the dataset only contains a few high-level factors, such as the 3D Chair dataset, it is hard to find explainable high-level disentangled representations in our network.\n\n---\n5. \"I suggest adding the paper [2] to the related work..\"\n\nSure, we have added these important references to \"Related work\" section. In addition, we have also added some discussion of renormalization group and flow-based modeling.", "title": "Response  to Reviewer 1"}, "mXWrD2SlHl6": {"type": "rebuttal", "replyto": "N6B0VtZR3oR", "comment": "Thanks for reviewing our paper, and pointing out some questions!\n\n---\n\n1. \"Similar flow architectures have been used before in different contexts (mostly physics) as also mentioned in the paper, but I feel that it is not so clear how the proposed normalizing flow model differs from previous work with a renormalisation group (NeuralRG).\"\n\nThe original NeuralRG is designed especially for physical systems for Monte Carlo simulations (Li & Wang, 2018) or study of latent space geometry (Hu et al., 2020). However, it cannot be directly applied to complicated natural images and there has not been results on natural image datasets. Through our trials, directly applying those structures to natural images leads to abysmal results. To apply the idea of RG to more complicated datasets, we implement more expressive local bijective maps involving deep residue blocks, swish activation, and weight normalization etc. Our implementation makes RG-Flow capable of generating natural images. We are the first to thoroughly discuss the multi-scale latent representations under the RG transformation. An additional contribution is that we define the receptive fields of flow-based models and generation/inference causal cones for better theoretical understanding of RG-Flow.\n\nIn the updated \"Experiments\" section and Appendix B, we add the discussion of our synthetic multiscale datasets MSDS1 and MSDS2, which illustrate that RG-Flow can separate high-level and low-level representations, while other flow-based models like Real NVP cannot achieve that. For the human face dataset, we also add the comparison with Real NVP in Appendix C.\n\n---\n\n\n2. \"The role of symmetric priors for disentangled representations has been studied previously (using information theoretical ideas, for VAEs etc) and I also feel that it should be clarified how the sparse Laplace prior differs from previous work.\"\n\n\nIn beta-TCVAE and FactorVAE, the high level disentanglement is encouraged by independence of latent variables. In RG-Flow, the information bottleneck is achieved by RG and all latent variables are independent. To make a step further, we use the sparse prior distribution as a heuristic method to encourage the disentanglement of latent variables, which may have overlapping receptive fields when not disentangled. The intuition is that the sparse distribution breaks the rotational symmetry of latent space, which is visualized in Appendix E.\n\nHowever, we are aware that the disentanglement of high-level representations in an unsupervised manner is an ill-defined problem, which is also the main conclusion of [1]. So it is not our focus to disentangle the high-level representations. In contrast, we find the disentanglement of mid-level and low-level representations in RG-Flow is well-defined. If the receptive fields of two latent variables are not overlapping, we can say they are disentangled. This is discussed for our newly added synthetic toy datasets, and also for the human face dataset.\n\n[1] Francesco Locatello, et al., Challenging Common Assumptions in the Unsupervised Learning of Disentangled Representations. (2019)\n\n\n---\n\n\n3. \"Does the choice of the temperature for the prior has a large influence on the learned features?\"\n\nDuring training we always set the variance of the prior distribution to 1, that is $T = 1$, so it will not influence the learned features. We only lower the temperatures for better visual quality when generating images from the trained network, as discussed in Appendix D.\n\n---\n\n4. \"How does the computational complexity and running time of the RG architecture compare with other flow based generative models like Glow/(plain) RNVP?\"\n\nIn the inpainting task, we showed that theoretically RG-Flow only need to do optimization on $O(\\log L)$ latent variables, while other flow-based generative models with global connections need to do so on all $L^2$ latent variables.\n\nFor now, the $O(\\log L)$ advantage is more of a theoretical one than a practical one. The advantage in asymptotic complexity will be significant when L is large, but because of our limited computation resources, we can only implement L up to 32. \n\n---\n\n5. \"But it is not clear to me how well the architecture performs for corruptions that are not just in a single local region.\"\n\nThe $O(\\log L)$ advantage is only valid if the corrupted region is small and local compared to the whole image. Otherwise, if the artifacts are not local, such as the salt-and-pepper type of noise distributed over the whole image, the union of the inference casual cones of those artifacts will cover almost all latent variables, and we need to optimize all of them. Even in that case, the quality of the inpainted image is comparable to other generative models like Real NVP.\n", "title": "Response to Reviewer 2"}, "8DDesv4Put": {"type": "rebuttal", "replyto": "yj4q2wBrVw8", "comment": "Thanks for reviewing our paper and pointing out some questions!\n\n---\n\n1. \".. Compared with the two mentioned NeuralRG papers .. the differences for the renormalization group part?\"\n\nFor this question, please kindly refer to our general comment (1) and (2).\n\n---\n\n\n2. \".. the visual results are with limited diversity. Does mode collapse happen ..?\"\n\nWe have added more samples in Appendix G, Fig. 13 to show the diversity of generated images, including different genders, skin tones, face orientations, expressions and more factors. \n\n---\n\n3. \".. too strong that enforces .. features at different layers .. a same sparse prior\"\n\nIt is also a choice to optimize the variance of the prior distribution of each latent variable, or add more optimizable parameters into the priors. Currently, we are not doing so, because the bijective maps can already scale the variance or change the shape of the priors.\n\n---\n\n4. \"..does proposed method work only on aligned/structured scenes?\"\n\nIn our network, we do not impose anything that favors aligned datasets. So it should also work on non-aligned datasets. We think that images in the wild naturally follow a multi-scale structure, which is captured by RG. Our implementation is largely based on Real NVP, which set the expressiveness of the bijective mapping. For natural dataset like CIFAR-10, we find RG-Flow achieves even better performance than Real NVP, please see Appendix G in the revision for the quantitative comparison. We feel this is a strong indication that RG-Flow captures the multiscale characteristics in CIFAR-10. We expect that if more advanced bijective maps are used, such as invertible convolutions and i-ResNet, the performance of RG-Flow can be further improved.\n\n---\n\n5. \"compared with the style-based generator[1,2] .. I don\u2019t find superiorities of the proposed method.\"\n\nThanks for pointing these interesting papers of style-based generative models, which can also perform the mixture of human face. The advantage of RG-Flow is that its mid-level and low-level representations have clear semantic meanings, and they are guaranteed to be disentangled since they do not overlap spatially. E.g. in the human face dataset, the mid-level factor of eyes will only change the eyes and not affect the hair, since they do not overlap.\n\n---\n\n6. \".. Fig. 12 is a bit weak to show the advantages of breaking the spherical symmetry .. What are the clusters in latent space, visual space ..\"\n\nWe agree that breaking symmetry of latent space is only a heuristic method. Practically we find it works well. Fig. 12 is an intuitive illustration. The different colors are not for clustering. Instead, they are used to visualize the correspondence between points in latent and visible spaces. This is an convenient visualization of the diffeomorphism. In the latent space, points in different quadrants are given different colors. \n\n---\n\n7. \"experiments .. on a low-resolution setting (i.e., 32x32 on CelebA) .. higher resolution?\"\n\nWe expect it will work on higher resolution images with more expressive local bijective maps as the performance of RG-Flow depends largely on the family of local bijective maps. \n\n---\n\n8. \"no .. evaluation to compare the performance ..\"\n\nFor the qualitative comparison, our discussion of Fig. 4 and Appendix C shows that RG-Flow can produce semantically meaningful representations from low level to high level which is theoretically guaranteed. In contrast, Real NVP cannot produce semantically meaningful mid-level or low-level representations.\n\nIn the revision, we create two synthetic toy datasets with multi-scale features, named MSDS1 and MSDS2. This is shown in \"Experiments\" section and in Appendix B, that RG-Flow can separately capture high-level and low-level features, while Real NVP fails to do so.\n\nFor the quantitative evaluation, there are already BPD scores to assess the quality and diversity of generated images in Appendix G. We have added FID as another metric. FID score is not widely used to assess flow-based models, because flow-based models can directly give the probability density of each generated sample, whereas GAN cannot. BPD may be a more fair metric on datasets of specific fields like human faces and synthetic datasets, and it avoids the bias from the knowledge encoded in Inception-v3.\n\nIn Appendix F, we also add the metrics of PSNR to quantitatively assess the quality of inpainted images with limited size of latent space for optimization. \n\n---\n\n9. \"to verify renormalization group helps .. semantics at different levels .. better to .. compare .. receptive field between w/ RG and w/o RG.\"\n\nSure! In Appendices B and C of the updated text, we add the comparison of RG-Flow and Real NVP as an ablation study. Except for RG, the structure of RG-Flow is largely similar to Real NVP.\n\n---\n\n10. \"What\u2019s the meaning of y in equation (5)?\"\n\ny is the intermediate result after transforming by the disentangler (green block in Fig. 2(b)), but not the decimator (yellow block). ", "title": "Response to Reviewer 3"}, "0UcEy69Tfzc": {"type": "rebuttal", "replyto": "67X7r-ufl1", "comment": "\nThanks for reviewing our paper and pointing out some questions!\n\n---\n\n1. \"more discussion how this paper relates to Neural Network Renormalization Group (Li & Wang). more background/examples ..\"\n\nSure, we have added another paragraph in \"Related work\" section to discuss the background of renormalization group, flow-based models, and exact holographic mapping. In addition, we added more experiments to illustrate difference between RG-Flow and other flow-based models. And please kindly refer to general comments (1) and (2).\n\n---\n\n2. \"no evaluation of the image inpainting performance\"\n\nThanks for the comment and we have added the metrics of PSNR and Inception-PSNR for inpainted images in Appendix F, which are consistent with the intuitive results in Fig. 7.\n\n---\n\n3. \"Constrained NVP seems to be too weak a baseline for the image inpainting task .. more reasonable comparisons?  .. log(L) vs L^2 improvement, timing or flop counts should be used to compare to Real NVP.\"\n\nWe claim that the dimension of the optimization space is $O(\\log L)$ in RG-Flow, instead of $L^2$. Within this constrained smaller space, the original image can be recovered. To demonstrate an apple-to-apple comparison, we think it is fair to compare constrained RG-Flow to constrained Real NVP.\n\nThe $O(\\log L)$ advantage is more of a theoretical one and showing such a space exists is interesting by itself. The advantage in asymptotic complexity will be significant when L is large, but because of our limited computation resources, we can only implement L up to 32. Also, RG-Flow frequently involves non-contiguous access of data when re-ordering the variables into RG blocks as in Fig. 2(b), which is not optimized in current ML frameworks. \n\n---\n\n4. \"The paper provides limited quantitative results and comparisons. There is no discussion of the 3D chair experiment in the appendix.\"\n\nWe provide BPD scores to quantitatively assess the quality and diversity of generated images in Appendix G, which are widely adopted for flow-based models.\n\nBased on your comment, we have added FID score as another metric. Note that FID score is not widely used to assess flow-based models, because flow-based models can directly give the probability density of each generated sample, which GAN cannot do. BPD may be a more fair metric on datasets of specific fields like human faces and synthetic datasets, and it avoids the bias from the knowledge encoded in Inception-v3. Also, in Appendix F, we have added the metrics of PSNR and Inception-PSNR to quantitatively assess the quality of inpainted images. In Appendix B where we discuss our newly added synthetic toy datasets, we include the metrics of BPD and FID as well.\n\nThe 3D Chair dataset is used to show a limitation of RG-Flow, which is discussed in \"Discussion and conclusion\" section. If the dataset only contains a few high-level factors, such as the 3D Chair dataset, it is hard to find explainable high-level disentangled representations in our network. The settings for 3D Chair dataset is mostly the same as for other experiments. We include the hyperparameters and results in Appendix G.\n\n---\n\n5. \"Notation in Eq 5. should be improved\"\n\nSure, we provide some improvement in the revision. Eq. 5 is provided only as a rigorous mathematical description of what is happening in Fig. 2, and you could also read Fig. 2 for an intuitive graphical understanding.\n\n---\n\n6. \"What is the reason for the checkerboard artifacts shown in the progressive generation (Figure 4)?\"\n\nThe checkerboard artifacts are related to the checkerboard mask used in the bipartite structure in our local bijective maps, similar to those in Real NVP. If we want to further reduce the artifact, we may use random masks in each layer, and add loss terms between the progressively generated images and downscaled ground truth images.\n\n---\n\n7. \"While theoretically each pixel only depends on log(L) latent variables...\"\n\nWe apologize that we can not understand this question based on its description, which seems incomplete. Based on our best guess, we would like to include the reply to the other reviewer here for better clarification.\n\nWe claim that the dimension of the optimization space is $O(\\log L)$ in RG-Flow, instead of $L^2$. Within this constrained smaller space, the original image can be recovered. To demonstrate an apple-to-apple comparison, we think it is fair to compare constrained RG-Flow to constrained Real NVP.\n\nThe $O(\\log L)$ advantage is more of a theoretical one and showing such a space exists is interesting by itself. The advantage in asymptotic complexity will be significant when L is large, but because of our limited computation resources, we can only implement L up to 32. Also, RG-Flow frequently involves non-contiguous access of data when re-ordering the variables into RG blocks as in Fig. 2(b), which is not optimized in current ML frameworks. \n", "title": "Response to Reviewer 4"}, "nmJ_NrCEa8B": {"type": "rebuttal", "replyto": "Mwuc0Plt_x2", "comment": "We thank all reviewers for their constructive feedbacks.\n\nIn light of the comments from the reviewers, we have made several significant changes in the revision: \n\n1. We add another paragraph in \"Related work\" section to discuss the previous works using renormalization group (RG) in tensor networks and neural networks. The original NeuralRG is designed especially for physical systems for Monte Carlo simulations (Li & Wang, 2018) or study of latent space geometry (Hu et al., 2020). However, it cannot be directly applied to complicated natural images and there has not been results on natural image datasets. Through our trials, directly applying those structures to natural images leads to abysmal results. To apply the idea of RG to more complicated datasets, we implement more expressive local bijective maps involving deep residue blocks, swish activation, and weight normalization etc. Our implementation makes RG-Flow capable of generating natural images. We are the first to thoroughly discuss the multi-scale latent representations under the RG transformation. An additional contribution is that we define the receptive fields of flow-based models and generation/inference causal cones for better theoretical understanding of RG-Flow.\n\n2. To better illustrate that RG-Flow can naturally separate representations at different scales, we propose two synthetic toy datasets with multi-scale features, named MSDS1 and MSDS2. In \"Experiments\" section and in Appendix B, we show that RG-Flow can separately capture high-level and low-level features, whereas Real NVP fails to do so. The dataset will be publicly available. Further, in Appendix C, We show the receptive fields of Real NVP trained on CelebA dataset as a comparison to those of RG-Flow. We show that RG-Flow can produce semantically meaningful representations at each scale, and the progressive growth of latent representations from low level to high level is theoretically guaranteed. In contrast, Real NVP cannot produce semantically meaningful mid-level or low-level representations.\n\n3. We provide more quantitative evaluations. In Appendix F, to quantitatively assess the quality of inpainted images, we add the metrics of PSNR and Inception-PSNR, and they are consistent with the intuitive results in Fig. 7. In Appendix G, we add FID score as another quantitative assessment of the quality and diversity of generated images. We have also updated BPD scores from new training results. Note that FID score is not widely adopted to assess flow-based models, because flow-based models can directly give the probability density of each generated sample, which GAN cannot do. BPD may be a more fair metric on datasets of specific fields like human faces and synthetic datasets, and it avoids the bias from the knowledge encoded in Inception-v3. See https://paperswithcode.com/sota/image-generation-on-cifar-10 for the adoption of those metrics.\n\nIn the following, we address each reviewer's comments specifically.", "title": "General comments"}, "N6B0VtZR3oR": {"type": "review", "replyto": "Mwuc0Plt_x2", "review": "Summary:\nThe submission suggests a generative model with a normalizing flow based on a renormalization group idea. This gives rise to a multi-scale latent representation by arranging bijective transformations hierarchically with depth scaling logarithmically with the input dimension. Extensive experiments on CelebA are conducted, illustrating the latent feature on different scales and image inpainting experiments.\n\nPositives:\nThe paper includes substantive experiments that (i) visualize the latent features on the different hierarchical levels, (ii) illustrate mixing of latent variables across different levels, (iii) show good performance in error correction. \nThe proposed RG-Flow network architecture is very interesting indeed and is new for the considered tasks as far as I am aware. The complexity of the approach can improve from O(L^2) for previous normalizing flows for image inpainting to O(log L). This is a very significant improvement (but it is not clear to me how well the architecture performs for corruptions that are not just in a single local region).\n\nNegatives:\nSimilar flow architectures have been used before in different contexts (mostly physics) as also mentioned in the paper, but I feel that it is not so clear how the proposed normalizing flow model differs from previous work with a renormalisation group (NeuralRG). The role of symmetric priors for disentangled representations has been studied previously (using information theoretical ideas, for VAEs etc) and I also feel that it should be clarified how the sparse Laplace prior differs from previous work. \n\nRecommendation:\nThis appears a borderline submission for me, but my confidence for assessing it is not that high. The experimental section is solid and I would consider increasing the score if the differences to previous work are made clearer.\n\nComments:\nDoes the choice of the temperature for the prior has a large influence on the learned features?\nHow does the computational complexity and running time of the RG architecture compare with other flow based generative models like Glow/(plain) RNVP?\n", "title": "Official Review 2", "rating": "5: Marginally below acceptance threshold", "confidence": "3: The reviewer is fairly confident that the evaluation is correct"}, "yj4q2wBrVw8": {"type": "review", "replyto": "Mwuc0Plt_x2", "review": "## Summary\n\nThe paper proposes a method, named as RG-flow, which combines the ideas of Renormalization group (RG) and flow-based models. The RG is applied to separate signal statistics of different scales in the input distribution and flow-based idea represents each scale information in its latent variables with sparse prior distribution. Inspired by receptive field from CNNs, the authors visualize the latent space representation, which reveals the progressive semantics at different levels as the instinctive expectation.\n\n## Strengths\n\n+. The proposed method presents a simple method to combine renormalization group and flow-based models.\n\n+. The visualized receptive field of latent space representation shows meaningful semantics at different levels, which is verified on CelebA.\n\n## Weaknesses/Concerns\n\n-. It seems like a combination of existing methods, including Flow-based methods, renormalization group and receptive field. Compared with the two mentioned NeuralRG papers(Li & Wang, 2018; Hu et al., 2020), what are the differences for the renormalization group part? The main contributions of the proposed method are not so clear.\n\n-. In the flow part, the high-dimensional visual variables are modeled by a sparse prior distribution, while the visual results (e.g., Figure 4, 5, 6 in the main paper) are with limited diversity. Does mode collapse happen during modeling the distribution?\n\n-. It could be too strong that enforces the high-dimensional features at different layers to follow a same sparse prior distribution. Though the proposed method achieve acceptable results on CelebA which is an almost aligned face dataset, it fails to model the images in the wild (e.g., CIFAR-10 on Figure 8 in supplementary). Does it mean the proposed method works only on aligned/structured scenes? Specially, compared with the style-based generator[1,2], where the sparse prior distribution is enforced only in the input z latent space, I don\u2019t find superiorities of the proposed method.\n\n[1] A Style-Based Generator Architecture for Generative Adversarial Networks, CVPR 2019.\n\n[2] StyleFlow: Attribute-conditioned Exploration of StyleGAN-Generated Images using Conditional Continuous Normalizing Flows, arXiv 2020\n\n-. Given the visualization methods can have a great effect on the results, Fig. 9 is a bit weak to show the advantages of breaking the spherical symmetry of the style latent. What are the clusters in latent space, visual space and target?   \n\n-. The experiments are conducted on a low-resolution setting (i.e., 32x32 on CelebA). Does it work on higher resolution?\n\n-. There is no qualitative and quantitative evalution to compare the performance or show the improvement gained by the proposed method.\n\n-. In order to verify renormalization group helps on learning more meaningful semantics at different levels, it's better to show an ablation study to compare the visualization of receptive field between w/ RG and w/o RG. \n\n-. What\u2019s the meaning of y in equation (5)? \n\n\n## Overall Recommendation\n\nBased on the above weaknesses/concerns, I rate the paper \"Marginally below acceptance threshold\". \n\n\n", "title": "Reasonable extension of flow-based method but contributions not significant", "rating": "5: Marginally below acceptance threshold", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}}}